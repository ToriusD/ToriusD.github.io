<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π –∫–≤–µ—Å—Ç</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            touch-action: manipulation;
            font-family: 'Comic Sans MS', cursive, Arial, sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        #game-container {
            position: relative;
            width: 95%;
            max-width: 500px;
            height: 65vh;
            max-height: 500px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            align-content: space-around;
            gap: 8px;
        }
        
        .item {
            width: 22%;
            min-width: 60px;
            aspect-ratio: 1/1;
            background: white;
            border-radius: 15px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            border: none;
            outline: none;
            touch-action: manipulation;
        }
        
        .item:active {
            transform: scale(0.95);
        }
        
        .item.active {
            background: #ff6b6b;
            color: white;
            transform: scale(0.95);
        }
        
        .item.correct {
            background: #2ecc71;
            color: white;
        }
        
        .item.wrong {
            background: #e74c3c;
            color: white;
        }
        
        #info-panel {
            width: 95%;
            max-width: 500px;
            padding: 12px 0;
            background: rgba(255, 255, 255, 0.7);
            display: flex;
            justify-content: center;
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        #level {
            color: #333;
        }
        
        #message {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            z-index: 100;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border: 3px solid #ff6b6b;
            width: 85%;
            max-width: 400px;
        }
        
        #message h2 {
            color: #ff6b6b;
            font-size: 1.8rem;
            margin: 0 0 12px 0;
            text-shadow: 2px 2px 0 rgba(255, 255, 255, 0.5);
        }
        
        #message p {
            color: #555;
            font-size: 1.1rem;
            margin: 0 0 18px 0;
            line-height: 1.4;
        }
        
        #restart-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            font-family: 'Comic Sans MS', cursive;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            -webkit-tap-highlight-color: transparent;
        }
        
        #restart-btn:active {
            transform: scale(0.95);
            background: #ff8e8e;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease-in-out;
        }
        
        #countdown {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4.5rem;
            font-weight: bold;
            color: #ff6b6b;
            text-shadow: 3px 3px 0 rgba(255, 255, 255, 0.5);
            z-index: 200;
            display: none;
        }

        @media (max-height: 700px) {
            #game-container {
                height: 60vh;
            }
            .item {
                font-size: 2rem;
            }
            #countdown {
                top: 15%;
                font-size: 3.5rem;
            }
        }

        @media (max-height: 600px) {
            #game-container {
                height: 55vh;
            }
            #countdown {
                top: 12%;
                font-size: 3rem;
            }
        }
    </style>
</head>
<body>
    <h1>–ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π –∫–≤–µ—Å—Ç</h1>
    <div id="info-panel">
        <div>–£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span>/<span id="max-level">5</span></div>
    </div>
    <div id="game-container"></div>
    <div id="message">
        <h2 id="message-title">üßê –ê —Ç–µ–ø–µ—Ä—å –ø–æ–¥—É–º–∞–π</h2>
        <p id="message-text">—Ç—É—Ç –∑–∞–≥–∞–¥–∫–∞</p>
        <button id="restart-btn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
    </div>
    <div id="countdown">3</div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–≥—Ä—ã
        const config = {
            items: ['üéÅ', 'üéÑ', 'üéÖ', 'üåü', 'üîî', '‚õÑ', 'ü¶å', 'üç™'],
            initialSequenceLength: 2,
            maxLevel: 5,
            showTime: 1000,
            hideTime: 500,
            levelUpStep: 1,
            countdownTime: 3
        };
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        let state = {
            level: 1,
            sequence: [],
            playerSequence: [],
            isShowing: false,
            isGameOver: false,
            currentStep: 0,
            tapLock: false
        };
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
        const gameContainer = document.getElementById('game-container');
        const levelEl = document.getElementById('level');
        const maxLevelEl = document.getElementById('max-level');
        const messageEl = document.getElementById('message');
        const messageTitleEl = document.getElementById('message-title');
        const messageTextEl = document.getElementById('message-text');
        const restartBtn = document.getElementById('restart-btn');
        const countdownEl = document.getElementById('countdown');
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å
        maxLevelEl.textContent = config.maxLevel;
        
        // –§—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞
        function startCountdown(callback) {
            let count = config.countdownTime;
            countdownEl.style.display = 'block';
            countdownEl.textContent = count;
            
            const timer = setInterval(() => {
                count--;
                countdownEl.textContent = count;
                
                if (count <= 0) {
                    clearInterval(timer);
                    countdownEl.style.display = 'none';
                    callback();
                }
            }, 1000);
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            state.level = 1;
            state.isGameOver = false;
            state.currentStep = 0;
            state.tapLock = false;
            
            levelEl.textContent = state.level;
            messageEl.style.display = 'none';
            
            createItems();
            
            startCountdown(() => {
                startRound();
            });
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        function createItems() {
            gameContainer.innerHTML = '';
            
            const shuffledItems = [...config.items].sort(() => 0.5 - Math.random());
            const selectedItems = shuffledItems.slice(0, 8);
            
            selectedItems.forEach((item, index) => {
                const itemEl = document.createElement('button');
                itemEl.className = 'item';
                itemEl.textContent = item;
                itemEl.dataset.index = index;
                
                // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
                itemEl.addEventListener('pointerdown', (e) => {
                    e.preventDefault();
                    if (state.tapLock || state.isShowing || state.isGameOver) return;
                    state.tapLock = true;
                    handleItemClick(index);
                    
                    // –°–Ω–∏–º–∞–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —á–µ—Ä–µ–∑ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è
                    setTimeout(() => {
                        state.tapLock = false;
                    }, 300);
                });
                
                gameContainer.appendChild(itemEl);
            });
        }
        
        // –ù–∞—á–∞–ª–æ —Ä–∞—É–Ω–¥–∞
        function startRound() {
            state.sequence = [];
            state.playerSequence = [];
            state.currentStep = 0;
            
            const items = document.querySelectorAll('.item');
            for (let i = 0; i < config.initialSequenceLength + (state.level - 1) * config.levelUpStep; i++) {
                const randomIndex = Math.floor(Math.random() * items.length);
                state.sequence.push(randomIndex);
            }
            
            showSequence(0);
        }
        
        // –ü–æ–∫–∞–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        function showSequence(index) {
            if (index >= state.sequence.length) {
                state.isShowing = false;
                return;
            }
            
            state.isShowing = true;
            const itemIndex = state.sequence[index];
            const item = document.querySelector(`.item[data-index="${itemIndex}"]`);
            
            item.classList.add('active', 'pulse');
            
            setTimeout(() => {
                item.classList.remove('active', 'pulse');
                
                setTimeout(() => {
                    showSequence(index + 1);
                }, config.hideTime);
            }, config.showTime);
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –ø—Ä–µ–¥–º–µ—Ç—É
        function handleItemClick(clickedIndex) {
            if (state.isShowing || state.isGameOver) return;
            
            const items = document.querySelectorAll('.item');
            const clickedItem = items[clickedIndex];
            
            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–æ–π –∫–Ω–æ–ø–∫–∏
            clickedItem.classList.add('pulse');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –Ω–∞–∂–∞—Ç–∞—è –∫–Ω–æ–ø–∫–∞ —Ç–µ–∫—É—â–µ–º—É —à–∞–≥—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            if (clickedIndex === state.sequence[state.currentStep]) {
                // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä
                clickedItem.classList.add('correct');
                state.currentStep++;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ª–∏ –≤—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
                if (state.currentStep === state.sequence.length) {
                    // –£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏–ª–∏ —É—Ä–æ–≤–µ–Ω—å
                    if (state.level >= config.maxLevel) {
                        endGame(true);
                    } else {
                        state.level++;
                        levelEl.textContent = state.level;
                        
                        if (state.level % 3 === 0) {
                            createItems();
                        }
                        
                        // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∏–ª–∏ –ø–µ—Ä–µ–¥ –Ω–æ–≤—ã–º —Ä–∞—É–Ω–¥–æ–º
                        setTimeout(() => {
                            items.forEach(item => {
                                item.classList.remove('correct', 'wrong', 'pulse');
                            });
                            startCountdown(() => {
                                startRound();
                            });
                        }, 800);
                    }
                }
            } else {
                // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä
                items.forEach(item => {
                    const itemIndex = parseInt(item.dataset.index);
                    if (itemIndex === state.sequence[state.currentStep]) {
                        item.classList.add('correct'); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, –∫–∞–∫–æ–π –¥–æ–ª–∂–µ–Ω –±—ã–ª –±—ã—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä
                    }
                });
                clickedItem.classList.add('wrong');
                setTimeout(() => endGame(false), 800);
            }
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–Ω—è—Ç–∏–µ –ø–æ–¥—Å–≤–µ—Ç–∫–∏
            setTimeout(() => {
                clickedItem.classList.remove('pulse');
            }, 300);
        }
        
        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
        function endGame(isWin) {
            state.isGameOver = true;
            
            if (isWin) {
                messageTitleEl.textContent = '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!';
                messageTextEl.textContent = `–í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–∏ –≤—Å–µ ${config.maxLevel} —É—Ä–æ–≤–Ω–µ–π! üéâ`;
            } else {
                messageTitleEl.textContent = '–û—à–∏–±–∫–∞!';
                messageTextEl.textContent = `–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–µ —Å–æ–±–ª—é–¥–µ–Ω–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑!`;
            }
            
            messageEl.style.display = 'block';
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∞
        restartBtn.addEventListener('click', initGame);
        
        // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
        document.addEventListener('DOMContentLoaded', () => {
            document.body.style.margin = '0';
            document.body.style.overflow = 'hidden';
            document.documentElement.style.overflow = 'hidden';
            
            initGame();
        });
    </script>
</body>
</html>
